(this["webpackJsonppoll-check"]=this["webpackJsonppoll-check"]||[]).push([[0],{204:function(e,t,a){e.exports=a(333)},209:function(e,t,a){},210:function(e,t,a){},333:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),l=a(56),r=a.n(l),i=(a(209),a(66)),o=a(193),c=a(29),u=a(30),h=a(32),p=a(31),d=a(33),m=(a(210),a(344)),g=a(341),f=a(343);function E(e){return s.a.createElement("div",null,s.a.createElement(m.a,{inverted:!0,style:{margin:"40px",height:"217px"}},s.a.createElement(g.a,{onSubmit:e.loginSubmitted},s.a.createElement(g.a.Input,{type:"text",name:"loginEmail",placeholder:"Email",value:e.loginEmail,onChange:e.handleChange}),s.a.createElement(g.a.Input,{type:"password",name:"loginPassword",placeholder:"Password",value:e.loginPassword,onChange:e.handleChange}),s.a.createElement(g.a.Button,{content:"login",type:"submit",value:"Log In"})),s.a.createElement(f.a,{size:"mini",onClick:e.handleSignupClick,style:{margin:"15px"}},"sign up")))}function k(e){return s.a.createElement("div",null,s.a.createElement(m.a,{inverted:!0,style:{margin:"40px"}},s.a.createElement(g.a,{onSubmit:e.SignUpSubmitted},s.a.createElement(g.a.Input,{type:"text",name:"signupName",placeholder:"Name",value:e.signupName,onChange:e.handleChange}),s.a.createElement(g.a.Input,{type:"text",name:"signupEmail",placeholder:"Email",value:e.signupEmail,onChange:e.handleChange}),s.a.createElement(g.a.Input,{type:"password",name:"signupPassword",placeholder:"Password",value:e.signupPassword,onChange:e.handleChange}),s.a.createElement(g.a.Button,{content:"sign up",type:"submit",value:"Sign Up"}))))}var C=a(346),S=a(347),b=a(34),v=a(39),y=a.n(v),w=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(s)))).state={signupName:"",signupEmail:"",signupPassword:"",loginEmail:"",loginPassword:"",errors:[],signupClicked:!1},a.loginSubmitted=function(e){e.preventDefault(),fetch("https://poll-check-backend.herokuapp.com/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a.state.loginEmail,password:a.state.loginPassword})}).then((function(e){return e.json()})).then((function(e){console.log(e),e.errors?a.setState({errors:e.message},window.alert("The email address or password you entered are invalid!")):(localStorage.setItem("token",e.token),a.props.fetchCurrentUser(),a.props.history.push("/home"))}))},a.SignUpSubmitted=function(e){e.preventDefault(),fetch("https://poll-check-backend.herokuapp.com/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a.state.signupName,email:a.state.signupEmail,password:a.state.signupPassword})}).then((function(e){return e.json()})).then((function(e){console.log(e),e.errors?a.setState({errors:e.errors},window.alert("The email address you entered is already in use!")):a.props.history.push("/home")}))},a.handleChange=function(e){e.persist(),a.setState(Object(i.a)({},e.target.name,e.target.value))},a.handleSignupClick=function(e){a.setState({signupClicked:!0},console.log("signup clicked"))},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return s.a.createElement(C.a,{centered:!0,columns:2,rows:2},s.a.createElement(C.a.Row,null,s.a.createElement(S.a,{style:{margin:"30px"}},s.a.createElement("img",{src:y.a,alt:"Ballot Box Icon"}),s.a.createElement("h1",null,"Poll Check"),s.a.createElement("h5",null,"rides - lines - voting problems?"),s.a.createElement("h4",null,"communicate with your neighbors about election day!"))),s.a.createElement(C.a.Row,null,this.state.signupClicked?s.a.createElement(k,{signupName:this.state.signupName,signupEmail:this.state.signupEmail,signuPpassword:this.state.signupPassword,handleChange:this.handleChange,SignUpSubmitted:this.SignUpSubmitted}):s.a.createElement(E,{loginEmail:this.state.loginEmail,loginPassword:this.state.loginPassword,handleChange:this.handleChange,loginSubmitted:this.loginSubmitted,handleSignupClick:this.handleSignupClick})))}}]),t}(n.Component),j=Object(b.e)(w),O=a(189),U=a(130),x=a(101),P=a(69);function T(e){var t=Object(n.useState)({latitude:40.736191,longitude:-73.844225,width:"100vw",height:"100vh",zoom:11}),a=Object(U.a)(t,2),l=a[0],r=a[1],i=Object(n.useState)(null),o=Object(U.a)(i,2),c=o[0],u=o[1];return Object(n.useEffect)((function(){var e=function(e){"Escape"===e.key&&u(null)};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[]),s.a.createElement(s.a.Fragment,null,s.a.createElement(x.c,Object.assign({},l,{mapboxApiAccessToken:"pk.eyJ1IjoibGlzYWxhcm9jaGVsbGUiLCJhIjoiY2szNjk3YWFiMW9mejNicGk3Z2ZuOWM3NiJ9.P1cF6H6nJzEaLvpkSiGllA",mapStyle:"mapbox://styles/lisalarochelle/ck36bxl2r08n81cpi5b8l1u7v",onViewportChange:function(e){r(e)},height:"615px",paddingLeft:"10px"}),s.a.createElement(g.a.Input,{size:"large",placeholder:"Site Address",onChange:e.handleChange,icon:{name:"search"},style:{margin:"40px"}}),e.searchResults(e.searchTerm).map((function(e){return s.a.createElement(x.a,{key:e.id,latitude:parseFloat(e.latitude),longitude:parseFloat(e.longitude)},s.a.createElement("div",null,s.a.createElement("img",{src:y.a,alt:"Ballot Box Icon",className:"marker-button",onClick:function(t){return u(e)}})))})),c?s.a.createElement(x.b,{key:c.id,site:c,channel:e.channel,messages:e.messages,selectedSite:e.selectedSite,siteClicked:e.siteClicked,handleSiteClick:e.handleSiteClick,latitude:parseFloat(c.latitude),longitude:parseFloat(c.longitude),onClose:function(){u(null)}},s.a.createElement("div",null,s.a.createElement("h4",null,c.site_name),s.a.createElement("p",null,"District ",c.council_district),s.a.createElement("p",null,c.street_number+" "+c.street_name+", "+c.borough),s.a.createElement("p",null,s.a.createElement(P.a,{name:"wheelchair",color:"teal"})," ",c.handicap_entrance),s.a.createElement(f.a,{onClick:function(t){return e.handleSiteClick(t,c)}},s.a.createElement(P.a,{name:"comments outline"}),"Chat"))):null))}var M=a(348),I=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(s)))).state={searchTerm:""},a.alertClick=function(){a.setState({count:a.state.count+1,color:"red"})},a.handleSiteClick=function(e,t){e.preventDefault(),console.log("site clicked",t.id),a.props.setSelectedSite(t),a.props.history.push("/chat/".concat(t.id))},a.searchResults=function(e){if(a.props.sites)return a.props.sites.filter((function(t){if(t.voter_entrance&&""!==a.searchTerm)return t.voter_entrance.includes(e)}))},a.handleChange=function(e){a.setState(Object(O.a)({},a.state,{searchTerm:e.target.value}),(function(){return a.searchResults(a.state.searchTerm)}),console.log(a.state.searchTerm))},a.logoutClicked=function(e){e.preventDefault(),a.props.handleLogout(),a.props.history.push("/login")},a.profileClicked=function(e){e.preventDefault(),a.props.history.push("/profile")},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return console.log("filteredSites",this.state.filteredSites),console.log("currentUser",this.props.currentUser),console.log("messages",this.props.messages),console.log("channel",this.props.channel),s.a.createElement(s.a.Fragment,null,s.a.createElement(C.a,{rows:2},s.a.createElement(C.a.Row,null,s.a.createElement(S.a,{as:"h3"},s.a.createElement("img",{src:y.a,alt:"Ballot Box Icon",style:{paddingLeft:"30px"}}),"Poll Check",s.a.createElement(M.a,{floated:"right"},s.a.createElement(M.a.Section,{link:!0,onClick:this.profileClicked},s.a.createElement("h4",null,"my account")),s.a.createElement(M.a.Divider,null,"/"),s.a.createElement(M.a.Section,{link:!0,onClick:this.logoutClicked},s.a.createElement("h4",null,"logout"))))),s.a.createElement(C.a.Row,null,s.a.createElement(T,{sites:this.props.sites,name:this.props.name,token:this.props.token,channel:this.props.channel,userId:this.props.userId,messages:this.props.messages,displayedSite:this.props.site,siteClicked:this.props.siteClicked,selectedSite:this.props.selectedSite,setSelectedSite:this.props.setSelectedSite,handleSiteClick:this.handleSiteClick,currentUser:this.props.currentUser,submitMessage:this.props.submitMessage,messageChange:this.props.messageChange,searchTerm:this.state.searchTerm,handleChange:this.handleChange,searchResults:this.searchResults,count:this.state.count,color:this.state.color,alertClick:this.alertClick}))))}}]),t}(n.Component),N=Object(b.e)(I),B=a(191),A=a(342),D=function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return console.log(this.props.messages),s.a.createElement(m.a,{style:{overflowY:"scroll",height:520}},s.a.createElement(B.a,null,void 0!==this.props.selectedSite.messages?this.props.messages.map((function(e){return s.a.createElement("div",{key:e.id},s.a.createElement(A.a,{margin:"10px"},s.a.createElement(A.a.Avatar,{src:"https://image.flaticon.com/icons/svg/126/126486.svg"}),s.a.createElement(A.a.Content,null,s.a.createElement(A.a.Author,null,e.username),s.a.createElement(A.a.Metadata,null,s.a.createElement("div",null,e.created_at.split("T")[0])),s.a.createElement(A.a.Text,null,e.content)),s.a.createElement(f.a,{size:"mini"},"Respond")))})):null))}}]),t}(n.Component);function L(e){return s.a.createElement("div",null,s.a.createElement(g.a,{onSubmit:e.submitMessage},s.a.createElement(g.a.Input,{inverted:!0,type:"text",placeholder:"send a message",onChange:e.messageChange})))}var _=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(s)))).logoutClicked=function(e){e.preventDefault(),a.props.handleLogout(),a.props.history.push("/login")},a.profileClicked=function(e){e.preventDefault(),a.props.history.push("/profile")},a.backToMap=function(e){e.preventDefault(),a.props.history.push("/home")},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return console.log("current user",this.props.currentUser.id),console.log("selectedSite",this.props.selectedSite),console.log("channel",this.props.channel.id),s.a.createElement(s.a.Fragment,null,s.a.createElement(m.a,{clearing:!0},s.a.createElement(S.a,{floated:"left",onClick:this.backToMap,style:{cursor:"pointer"}},s.a.createElement("img",{src:y.a,alt:"Ballot Box Icon",style:{height:"40px",width:"40px"}}),"Poll Check"),s.a.createElement(S.a,{floated:"right"},this.props.selectedSite.site_name,s.a.createElement(M.a,null,s.a.createElement(M.a.Section,{link:!0,onClick:this.profileClicked},s.a.createElement("h4",null,"my account")),s.a.createElement(M.a.Divider,null,"/"),s.a.createElement(M.a.Section,{link:!0,onClick:this.logoutClicked},s.a.createElement("h4",null,"logout"))))),s.a.createElement(m.a,{color:"black",width:"1000px"},s.a.createElement(D,{selectedSite:this.props.selectedSite,messages:this.props.messages}),s.a.createElement(L,{newMessage:this.props.newMessage,handleChange:this.handleChange,submitMessage:this.props.submitMessage,messageChange:this.props.messageChange})))}}]),t}(n.Component),z=Object(b.e)(_),F=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(s)))).handleDeleteUser=function(){fetch("https://poll-check-backend.herokuapp.com/users/".concat(a.props.currentUser.id),{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(localStorage.token)}}),localStorage.clear(),a.props.history.push("/login")},a.backToMap=function(e){e.preventDefault(),a.props.history.push("/home")},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return console.log(this.props.currentUser),s.a.createElement("div",null,s.a.createElement(m.a,{clearing:!0},s.a.createElement(S.a,{as:"h3",onClick:this.backToMap,style:{cursor:"pointer"}},s.a.createElement("img",{src:y.a,alt:"Ballot Box Icon",style:{height:"40px",width:"40px"}}),"Poll Check")),s.a.createElement("h1",null," ",this.props.currentUser.name," "),this.props.currentUser.email,s.a.createElement(g.a,{style:{margin:"10px"},onSubmit:this.props.handleEditSubmit},s.a.createElement(g.a.Input,{type:"text",name:"editName",placeholder:"Name",value:this.props.editName,onChange:this.props.handleEditChange}),s.a.createElement(g.a.Input,{type:"text",name:"editEmail",placeholder:"Email",value:this.props.editEmail,onChange:this.props.handleEditChange}),s.a.createElement(g.a.Input,{type:"password",name:"editPassword",placeholder:"Password",value:this.props.editPassword,onChange:this.props.handleEditChange}),s.a.createElement(g.a.Button,{style:{margin:"10px"},content:"update account",type:"submit",value:"sign Up"}),s.a.createElement(g.a.Button,{style:{margin:"10px"},content:"delete account",value:"delete account",onClick:this.handleDeleteUser})))}}]),t}(n.Component),J=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(s)))).state={sites:[],messages:[],newMessage:"",channel:{},siteClicked:!1,selectedSite:{},currentUser:{},editName:"",editEmail:"",editPassword:"",errors:[]},a.setSelectedSite=function(e){a.setState({siteClicked:!a.state.siteClicked,selectedSite:e,messages:e.messages})},a.fetchChannels=function(){fetch("https://poll-check-backend.herokuapp.com/channels",{}).then((function(e){return e.json()})).then((function(e){a.setState({channel:e[2]})}))},a.fetchCurrentUser=function(){fetch("https://poll-check-backend.herokuapp.com/profile",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){return a.setState({currentUser:e},(function(){return console.log("current user",a.state.currentUser)}))}))},a.submitMessage=function(e){e.preventDefault(),e.persist(),fetch("https://poll-check-backend.herokuapp.com/messages",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(localStorage.token)},body:JSON.stringify({content:a.state.newMessage,user_id:a.state.currentUser.id,poll_site_id:a.state.selectedSite.id,channel_id:a.state.channel.id,username:a.state.currentUser.name})}).then((function(e){return e.json()})).then((function(e){return a.setState({messages:[].concat(Object(o.a)(a.state.messages),[e]),newMessage:""})})),e.target.reset()},a.messageChange=function(e){e.preventDefault(),a.setState({newMessage:e.target.value},(function(){return console.log(a.state.newMessage)}))},a.handleLogout=function(){localStorage.clear(),a.setState({currentUser:{}})},a.handleEditChange=function(e){a.setState(Object(i.a)({},e.target.name,e.target.value),(function(){return console.log(a.state.editName)}))},a.handleEditSubmit=function(e){e.preventDefault(),fetch("https://poll-check-backend.herokuapp.com/users/".concat(a.state.currentUser.id),{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(localStorage.token)},body:JSON.stringify({name:a.state.editName,email:a.state.editEmail,password:a.state.editPassword})}).then((function(e){return e.json()})).then((function(e){console.log(e),e.errors&&a.setState({errors:e.errors})})),a.fetchCurrentUser(),window.location.reload()},a.maintainSelectedSite=function(){fetch("https://poll-check-backend.herokuapp.com/poll_sites/".concat(a.props.match.path.split("/")[2])).then((function(e){return e.json()})).then((function(e){return a.setState({selectedSite:e})}))},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("https://poll-check-backend.herokuapp.com/poll_sites").then((function(e){return e.json()})).then((function(t){return e.setState({sites:t})})),this.fetchChannels(),this.fetchCurrentUser()}},{key:"render",value:function(){var e=this;return console.log("cUser",this.state.currentUser),console.log("messages",this.state.messages),console.log("channel",this.state.channel),console.log("selectedSite",this.state.selectedSite),s.a.createElement(s.a.Fragment,null,s.a.createElement(b.a,{path:"/login",render:function(t){return s.a.createElement(j,Object.assign({},t,{gotToken:e.gotToken,fetchCurrentUser:e.fetchCurrentUser}))}}),s.a.createElement(b.a,{path:"/home",render:function(t){return s.a.createElement(N,Object.assign({},t,{sites:e.state.sites,messages:e.state.messages,channel:e.state.channel,siteClicked:e.state.siteClicked,selectedSite:e.state.selectedSite,handleSiteClick:e.handleSiteClick,currentUser:e.state.currentUser,submitMessage:e.submitMessage,setSelectedSite:e.setSelectedSite,handleLogout:e.handleLogout,handleProfileClick:e.handleProfileClick,logoutClicked:e.logoutClicked,profileClicked:e.profileClicked}))}}),s.a.createElement(b.a,{path:"/chat/".concat(this.state.selectedSite.id),render:function(t){return s.a.createElement(z,Object.assign({},t,{messages:e.state.messages,newMessage:e.state.newMessage,channel:e.state.channel,handleSiteClick:e.handleSiteClick,currentUser:e.state.currentUser,submitMessage:e.submitMessage,messageChange:e.messageChange,siteClicked:e.state.siteClicked,selectedSite:e.state.selectedSite,setSelectedSite:e.setSelectedSite,maintainSelectedSite:e.maintainSelectedSite,handleLogout:e.handleLogout,handleProfileClick:e.handleProfileClick,logoutClicked:e.logoutClicked,profileClicked:e.profileClicked}))}}),s.a.createElement(b.a,{path:"/profile",render:function(t){return s.a.createElement(F,Object.assign({},t,{currentUser:e.state.currentUser,editName:e.state.editName,editEmail:e.state.editEmail,editPassword:e.state.editPassword,handleEditChange:e.handleEditChange,handleEditSubmit:e.handleEditSubmit}))}}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(332);var R=a(95);r.a.render(s.a.createElement(R.a,{basename:"/poll-check-frontend"},s.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},39:function(e,t,a){e.exports=a.p+"static/media/BallotIcon.22695509.svg"}},[[204,1,2]]]);